<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸Šä¸Šç­¾ - Demoç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #FFF8DC, #FFFACD);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #D97706, #F59E0B);
            color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(217, 119, 6, 0.3);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            padding: 8px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .tab.active {
            background: #D97706;
            color: white;
        }
        
        .tab:not(.active):hover {
            background: #f5f5f5;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .fortune-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .fortune-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
        }
        
        .fortune-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #D97706;
        }
        
        .fortune-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .fortune-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #374151;
        }
        
        .fortune-desc {
            font-size: 0.9rem;
            color: #6b7280;
            line-height: 1.4;
        }
        
        .result-display {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .result-display.show {
            display: block;
        }
        
        .fortune-level {
            font-size: 1.2rem;
            color: #D97706;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .fortune-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #374151;
        }
        
        .fortune-content {
            font-size: 1.3rem;
            color: #1f2937;
            margin-bottom: 25px;
            line-height: 1.6;
            font-weight: 500;
        }
        
        .fortune-explanation {
            font-size: 1rem;
            color: #6b7280;
            line-height: 1.8;
            text-align: left;
            background: #f9fafb;
            padding: 20px;
            border-radius: 10px;
        }
        
        .card-result {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #e0f2fe, #e8f5e8);
            border-radius: 15px;
            border: 2px solid #10b981;
        }
        
        .card-result h3 {
            color: #059669;
            margin-bottom: 10px;
        }
        
        .draw-btn {
            background: linear-gradient(135deg, #D97706, #F59E0B);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .draw-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(217, 119, 6, 0.4);
        }
        
        .draw-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        
        .loading {
            display: none;
            margin-top: 20px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #D97706;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .ai-form {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #D97706;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .ai-result {
            margin-top: 25px;
            padding: 25px;
            background: linear-gradient(135deg, #fef3c7, #fed7aa);
            border-radius: 15px;
            border: 2px solid #f59e0b;
        }
        
        .ai-result h3 {
            color: #d97706;
            margin-bottom: 15px;
        }
        
        .suggestion-list,
        .caution-list {
            margin: 15px 0;
        }
        
        .suggestion-list li,
        .caution-list li {
            margin: 8px 0;
            padding: 8px 0;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .card-item {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .card-item:hover {
            transform: translateY(-5px);
        }
        
        .card-image {
            width: 100%;
            height: 150px;
            background: linear-gradient(45deg, #fbbf24, #f59e0b);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
        }
        
        .card-info {
            padding: 15px;
        }
        
        .card-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #374151;
        }
        
        .card-type {
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 8px;
        }
        
        .status-valid {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-expired {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‹ ä¸Šä¸Šç­¾</h1>
            <p>AIæ™ºèƒ½æŠ½ç­¾ â€¢ ä¼ ç»Ÿä¸ç°ä»£çš„å®Œç¾ç»“åˆ</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="lottery">æŠ½ç­¾</div>
            <div class="tab" data-tab="ai">AIç®—å‘½</div>
            <div class="tab" data-tab="cards">å¡ç‰Œ</div>
            <div class="tab" data-tab="history">å†å²</div>
        </div>
        
        <!-- æŠ½ç­¾é¡µé¢ -->
        <div id="lottery" class="tab-content active">
            <div class="fortune-grid" id="fortuneTypes">
                <!-- ç­¾æ–‡ç±»å‹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="result-display" id="drawResult">
                <div class="fortune-level" id="resultLevel">ä¸Šä¸Šç­¾</div>
                <div class="fortune-title" id="resultTitle">ç­¾æ–‡æ ‡é¢˜</div>
                <div class="fortune-content" id="resultContent">ç­¾æ–‡å†…å®¹</div>
                <div class="fortune-explanation" id="resultExplanation">ç­¾æ–‡è§£é‡Š</div>
                <div id="cardResult" style="display: none;"></div>
                <button class="draw-btn" onclick="resetDraw()">é‡æ–°æŠ½ç­¾</button>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>æ­£åœ¨ä¸ºæ‚¨æŠ½å–ä¸Šä¸Šç­¾...</p>
            </div>
        </div>
        
        <!-- AIç®—å‘½é¡µé¢ -->
        <div id="ai" class="tab-content">
            <div class="ai-form">
                <h2 style="margin-bottom: 25px; color: #374151;">ğŸ¤– AIæ™ºèƒ½ç®—å‘½</h2>
                
                <div class="form-group">
                    <label>æ€§åˆ«</label>
                    <select id="gender">
                        <option value="1">ç”·</option>
                        <option value="2">å¥³</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>å’¨è¯¢ç±»å‹</label>
                    <select id="consultType">
                        <option value="äº‹ä¸š">äº‹ä¸šè¿åŠ¿</option>
                        <option value="å§»ç¼˜">å§»ç¼˜è¿åŠ¿</option>
                        <option value="å¥åº·">å¥åº·è¿åŠ¿</option>
                        <option value="è´¢è¿">è´¢è¿è¿åŠ¿</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>å‡ºç”Ÿå¹´ä»½ï¼ˆå¯é€‰ï¼‰</label>
                    <input type="number" id="birthYear" placeholder="å¦‚ï¼š1990" min="1950" max="2024">
                </div>
                
                <div class="form-group">
                    <label>é—®é¢˜æè¿°</label>
                    <textarea id="question" placeholder="è¯·æè¿°æ‚¨æƒ³å’¨è¯¢çš„é—®é¢˜..."></textarea>
                </div>
                
                <button class="draw-btn" onclick="submitAI()">å¼€å§‹ç®—å‘½</button>
                
                <div class="ai-result" id="aiResult" style="display: none;">
                    <h3>ğŸ¤– AIç®—å‘½ç»“æœ</h3>
                    <div id="aiSummary"></div>
                    <div class="suggestion-list" id="aiSuggestions"></div>
                    <div class="caution-list" id="aiCautions"></div>
                </div>
            </div>
        </div>
        
        <!-- å¡ç‰Œé¡µé¢ -->
        <div id="cards" class="tab-content">
            <h2 style="margin-bottom: 25px; color: #374151;">ğŸƒ æˆ‘çš„å¡ç‰Œæ”¶è—</h2>
            <div class="cards-grid" id="cardsGrid">
                <!-- å¡ç‰Œå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- å†å²é¡µé¢ -->
        <div id="history" class="tab-content">
            <h2 style="margin-bottom: 25px; color: #374151;">ğŸ“œ æŠ½ç­¾å†å²</h2>
            <div id="historyList">
                <!-- å†å²è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script src="./utils/mockData.js"></script>
    <script>
        // Mock APIæœåŠ¡ç±»
        class MockAPIService {
            constructor() {
                this.user = { userId: 1, nickname: "æµ‹è¯•ç”¨æˆ·" };
                this.drawHistory = [];
                this.aiHistory = [];
                this.currentCards = [];
            }

            async drawLottery(type) {
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const fortunes = [
                    {
                        id: 1, type: "äº‹ä¸š", category: "èŒåœºå‘å±•",
                        title: "ä¸Šä¸Šç­¾Â·é¹ç¨‹ä¸‡é‡Œ",
                        content: "æ˜¥é£å¾—æ„é©¬è¹„ç–¾ï¼Œä¸€æ—¥çœ‹å°½é•¿å®‰èŠ±",
                        explanation: "è¿‘æœŸäº‹ä¸šè¿åŠ¿æä½³ï¼Œæ­£æ˜¯å±•ç¿…é«˜é£çš„å¥½æ—¶æœºã€‚å·¥ä½œä¸­çš„åŠªåŠ›å°†å¾—åˆ°è®¤å¯ï¼Œæœ‰æœ›è·å¾—æ™‹å‡æœºä¼šæˆ–é‡è¦é¡¹ç›®çš„ä¸»å¯¼æƒã€‚",
                        level: 1
                    },
                    {
                        id: 2, type: "äº‹ä¸š", category: "èŒåœºå‘å±•",
                        title: "ä¸Šç­¾Â·ç¨³ä¸­æ±‚è¿›", 
                        content: "å±±é‡æ°´å¤ç–‘æ— è·¯ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘",
                        explanation: "äº‹ä¸šè·¯ä¸Šè™½æœ‰æ³¢æŠ˜ï¼Œä½†åšæŒä¸æ‡ˆç»ˆå°†è¿æ¥è½¬æœºã€‚æ–°é¡¹ç›®æˆ–æŠ•èµ„æœºä¼šå³å°†å‡ºç°ï¼Œéœ€è¦è°¨æ…è¯„ä¼°åæœæ–­è¡ŒåŠ¨ã€‚",
                        level: 2
                    },
                    {
                        id: 4, type: "å§»ç¼˜", category: "æ‹çˆ±æ¡ƒèŠ±",
                        title: "ä¸Šä¸Šç­¾Â·ä½³å¶å¤©æˆ",
                        content: "å…³å…³é›é¸ ï¼Œåœ¨æ²³ä¹‹æ´²ã€‚çªˆçª•æ·‘å¥³ï¼Œå›å­å¥½é€‘",
                        explanation: "å§»ç¼˜è¿åŠ¿æ—ºç››ï¼Œå•èº«è€…æœ‰æœ›åœ¨ç¤¾äº¤åœºåˆé‡åˆ°å¿ƒä»ªå¯¹è±¡ã€‚æœ‰ä¼´ä¾£è€…æ„Ÿæƒ…æ›´åŠ ç¨³å®šç”œèœœï¼Œé€‚åˆè€ƒè™‘è¿›ä¸€æ­¥å‘å±•ã€‚",
                        level: 1
                    },
                    {
                        id: 7, type: "å¥åº·", category: "å…»ç”Ÿä¿å¥",
                        title: "ä¸Šä¸Šç­¾Â·ç¦å¯¿å®‰åº·",
                        content: "æ¾é¹¤å»¶å¹´ï¼Œç¦å¦‚ä¸œæµ·",
                        explanation: "å¥åº·è¿åŠ¿æä½³ï¼Œèº«ä½“æŠµæŠ—åŠ›å¼ºï¼Œç²¾ç¥çŠ¶æ€è‰¯å¥½ã€‚å»ºè®®æ³¨æ„åŠ³é€¸ç»“åˆï¼Œé¿å…è¿‡åº¦ç–²åŠ³ï¼Œå®šæœŸä½“æ£€é¢„é˜²ä¸ºä¸»ã€‚",
                        level: 1
                    },
                    {
                        id: 9, type: "è´¢è¿", category: "åè´¢è¿",
                        title: "ä¸Šä¸Šç­¾Â·æ„å¤–ä¹‹è´¢",
                        content: "å¿½å¦‚ä¸€å¤œæ˜¥é£æ¥ï¼Œåƒæ ‘ä¸‡æ ‘æ¢¨èŠ±å¼€",
                        explanation: "åè´¢è¿æ—ºç››ï¼Œæœ‰æœºä¼šè·å¾—æ„å¤–ä¹‹è´¢ï¼Œå¦‚ä¸­å¥–ã€ç¤¼ç‰©æˆ–å…¶ä»–æ”¶å…¥æ¥æºã€‚ä½†è¦æ³¨æ„ç†è´¢è§„åˆ’ï¼Œé¿å…æŒ¥éœæ— åº¦ã€‚",
                        level: 1
                    }
                ];
                
                const fortune = fortunes.find(f => f.type === type) || fortunes[Math.floor(Math.random() * fortunes.length)];
                const hasCard = Math.random() < 0.3;
                
                const card = hasCard ? {
                    id: Date.now(),
                    name: fortune.type === "äº‹ä¸š" ? "é¹ç¨‹ä¸‡é‡Œå¡" : 
                          fortune.type === "å§»ç¼˜" ? "ä½³å¶å¤©æˆå¡" :
                          fortune.type === "å¥åº·" ? "ç¦å¯¿å®‰åº·å¡" : "è´¢æºæ»šæ»šå¡",
                    type: fortune.type,
                    description: "è±¡å¾" + fortune.type + "è¿åŠ¿æ—ºç››"
                } : null;
                
                return { fortune, card };
            }

            async aiConsult(consultData) {
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const responses = {
                    "äº‹ä¸š": {
                        summary: "è¿‘æœŸå·¥ä½œå‹åŠ›è¾ƒå¤§ï¼Œä½†æ­£é¢ä¸´é‡è¦çš„è½¬å˜æœºé‡ã€‚",
                        suggestions: [
                            "ä¿æŒå†·é™ï¼Œç†æ€§åˆ†æå½“å‰å·¥ä½œçŠ¶å†µ",
                            "å¯ä»¥å¼€å§‹å…³æ³¨æ–°çš„æœºä¼šï¼Œä½†ä¸è¦æ€¥äºè¡ŒåŠ¨",
                            "ä¸ä¿¡ä»»çš„æœ‹å‹æˆ–å¯¼å¸ˆäº¤æµï¼Œè·å¾—å»ºè®®"
                        ],
                        cautions: [
                            "é¿å…å› ä¸ºä¸€æ—¶å†²åŠ¨è€Œåšå‡ºé‡å¤§å†³å®š",
                            "æ³¨æ„èº«ä½“å¥åº·ï¼Œé€‚å½“å‡å‹"
                        ]
                    },
                    "å§»ç¼˜": {
                        summary: "æ„Ÿæƒ…è¿åŠ¿å¹³ç¨³ä¸Šå‡ï¼Œå•èº«è€…æœ‰æœ›é‡åˆ°å¿ƒä»ªå¯¹è±¡ã€‚",
                        suggestions: [
                            "ä¿æŒç§¯æä¹è§‚çš„å¿ƒæ€ï¼ŒçœŸè¯šå¾…äºº",
                            "å¯ä»¥å¤šå‚åŠ ç¤¾äº¤æ´»åŠ¨ï¼Œæ‰©å¤§äº¤å‹åœˆ",
                            "æ³¨æ„è‡ªèº«å½¢è±¡ï¼Œå±•ç°ä¸ªäººé­…åŠ›"
                        ],
                        cautions: [
                            "é¿å…è¿‡äºæ€¥èºï¼Œçˆ±æƒ…éœ€è¦è€å¿ƒç­‰å¾…",
                            "ä¸è¦è¢«è¡¨é¢ç°è±¡è¿·æƒ‘ï¼Œè¦ç”¨å¿ƒè§‚å¯Ÿ"
                        ]
                    },
                    "å¥åº·": {
                        summary: "èº«ä½“çŠ¶å†µè‰¯å¥½ï¼Œç²¾ç¥é¥±æ»¡ï¼ŒæŠµæŠ—åŠ›è¾ƒå¼ºã€‚",
                        suggestions: [
                            "ä¿æŒè§„å¾‹çš„ä½œæ¯ï¼Œæ—©ç¡æ—©èµ·èº«ä½“å¥½",
                            "é€‚é‡è¿åŠ¨ï¼Œå¢å¼ºä½“è´¨å’Œå…ç–«åŠ›",
                            "æ³¨æ„é¥®é£Ÿå‡è¡¡ï¼Œå¤šåƒè”¬èœæ°´æœ"
                        ],
                        cautions: [
                            "é¿å…è¿‡åº¦ç–²åŠ³ï¼Œæ³¨æ„åŠ³é€¸ç»“åˆ",
                            "å®šæœŸä½“æ£€ï¼Œé¢„é˜²èƒœäºæ²»ç–—"
                        ]
                    },
                    "è´¢è¿": {
                        summary: "è´¢è¿å¹³ç¨³ï¼Œé€‚åˆç¨³å¥ç†è´¢ï¼Œä¸å®œå†’é™©æŠ•èµ„ã€‚",
                        suggestions: [
                            "å¯ä»¥å…³æ³¨ä½é£é™©çš„ç†è´¢äº§å“",
                            "åˆç†è§„åˆ’æ”¯å‡ºï¼Œé¿å…å†²åŠ¨æ¶ˆè´¹",
                            "é€‚å½“å‚¨è“„ï¼Œä¸ºæœªæ¥åšå‡†å¤‡"
                        ],
                        cautions: [
                            "é¿å…é«˜é£é™©æŠ•èµ„ï¼Œé˜²èŒƒè´¢åŠ¡é£é™©",
                            "ä¸è¦è½»ä¿¡ä»–äººå»ºè®®ï¼Œåšå¥½ç‹¬ç«‹åˆ¤æ–­"
                        ]
                    }
                };
                
                return responses[consultData.consultType] || responses["äº‹ä¸š"];
            }
        }

        const mockAPI = new MockAPIService();
        
        // ç­¾æ–‡ç±»å‹æ•°æ®
        const fortuneTypes = [
            { type: "äº‹ä¸š", name: "äº‹ä¸šè¿åŠ¿", icon: "ğŸ’¼", desc: "èŒåœºå‘å±•ã€å·¥ä½œæœºä¼š" },
            { type: "å§»ç¼˜", name: "å§»ç¼˜è¿åŠ¿", icon: "ğŸ’•", desc: "æ„Ÿæƒ…è¿åŠ¿ã€æ¡ƒèŠ±è¿" },
            { type: "å¥åº·", name: "å¥åº·è¿åŠ¿", icon: "ğŸ’ª", desc: "èº«ä½“çŠ¶å†µã€å…»ç”Ÿä¿å¥" },
            { type: "è´¢è¿", name: "è´¢è¿è¿åŠ¿", icon: "ğŸ’°", desc: "æŠ•èµ„ç†è´¢ã€è´¢å¯Œè¿åŠ¿" },
            { type: "ç»¼åˆ", name: "ç»¼åˆè¿åŠ¿", icon: "ğŸŒŸ", desc: "æ•´ä½“è¿åŠ¿ã€é‡è¦å†³ç­–" }
        ];

        // æ¨¡æ‹Ÿå¡ç‰Œæ•°æ®
        const mockCards = [
            { id: 1, name: "é¹ç¨‹ä¸‡é‡Œå¡", type: "äº‹ä¸š", status: "valid" },
            { id: 2, name: "ä½³å¶å¤©æˆå¡", type: "å§»ç¼˜", status: "valid" },
            { id: 3, name: "ç¦å¯¿å®‰åº·å¡", type: "å¥åº·", status: "valid" },
            { id: 4, name: "è´¢æºæ»šæ»šå¡", type: "è´¢è¿", status: "valid" }
        ];

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initFortuneTypes();
            initCards();
            initHistory();
            
            // æ ‡ç­¾åˆ‡æ¢
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
        });

        function initFortuneTypes() {
            const container = document.getElementById('fortuneTypes');
            container.innerHTML = '';
            
            fortuneTypes.forEach(type => {
                const card = document.createElement('div');
                card.className = 'fortune-card';
                card.innerHTML = `
                    <div class="fortune-icon">${type.icon}</div>
                    <div class="fortune-name">${type.name}</div>
                    <div class="fortune-desc">${type.desc}</div>
                `;
                card.addEventListener('click', () => startDraw(type.type));
                container.appendChild(card);
            });
        }

        async function startDraw(type) {
            const resultDiv = document.getElementById('drawResult');
            const loadingDiv = document.getElementById('loading');
            const cards = document.querySelectorAll('.fortune-card');
            
            // ç¦ç”¨æ‰€æœ‰å¡ç‰‡
            cards.forEach(card => card.style.pointerEvents = 'none');
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            loadingDiv.style.display = 'block';
            resultDiv.classList.remove('show');
            
            try {
                const result = await mockAPI.drawLottery(type);
                const { fortune, card } = result;
                
                // æ˜¾ç¤ºç»“æœ
                document.getElementById('resultLevel').textContent = 
                    fortune.level === 1 ? 'ä¸Šä¸Šç­¾' : 'ä¸Šç­¾';
                document.getElementById('resultTitle').textContent = fortune.title;
                document.getElementById('resultContent').textContent = fortune.content;
                document.getElementById('resultExplanation').textContent = fortune.explanation;
                
                // æ˜¾ç¤ºå¡ç‰Œç»“æœ
                const cardResult = document.getElementById('cardResult');
                if (card) {
                    cardResult.innerHTML = `
                        <div class="card-result">
                            <h3>ğŸ æ­å–œè·å¾—ç¨€æœ‰å¡ç‰Œï¼</h3>
                            <p><strong>${card.name}</strong></p>
                            <p>${card.description}</p>
                        </div>
                    `;
                    cardResult.style.display = 'block';
                    
                    // æ·»åŠ åˆ°å¡ç‰Œåˆ—è¡¨
                    mockCards.push(card);
                } else {
                    cardResult.style.display = 'none';
                }
                
                // éšè—åŠ è½½çŠ¶æ€ï¼Œæ˜¾ç¤ºç»“æœ
                loadingDiv.style.display = 'none';
                resultDiv.classList.add('show');
                
                // æ·»åŠ åˆ°å†å²è®°å½•
                mockAPI.drawHistory.unshift({
                    id: Date.now(),
                    fortune,
                    card,
                    time: new Date().toLocaleString(),
                    hasCard: !!card
                });
                
            } catch (error) {
                alert('æŠ½ç­¾å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        function resetDraw() {
            document.getElementById('drawResult').classList.remove('show');
            document.getElementById('loading').style.display = 'none';
            
            // é‡æ–°å¯ç”¨æ‰€æœ‰å¡ç‰‡
            document.querySelectorAll('.fortune-card').forEach(card => {
                card.style.pointerEvents = 'auto';
            });
        }

        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„activeç±»
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºå½“å‰æ ‡ç­¾
            document.getElementById(tabName).classList.add('active');
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        function initCards() {
            const container = document.getElementById('cardsGrid');
            container.innerHTML = '';
            
            mockCards.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card-item';
                cardDiv.innerHTML = `
                    <div class="card-image">ğŸƒ</div>
                    <div class="card-info">
                        <div class="card-name">${card.name}</div>
                        <div class="card-type">${card.type}ç±»å‹</div>
                        <span class="status-badge status-${card.status}">
                            ${card.status === 'valid' ? 'æœ‰æ•ˆ' : 'å·²è¿‡æœŸ'}
                        </span>
                    </div>
                `;
                container.appendChild(cardDiv);
            });
        }

        function initHistory() {
            const container = document.getElementById('historyList');
            container.innerHTML = '';
            
            if (mockAPI.drawHistory.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6b7280; margin: 50px 0;">æš‚æ— æŠ½ç­¾è®°å½•</p>';
                return;
            }
            
            mockAPI.drawHistory.forEach(record => {
                const historyDiv = document.createElement('div');
                historyDiv.className = 'result-display';
                historyDiv.innerHTML = `
                    <div style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 15px;">
                            <span style="background: #D97706; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.9rem;">
                                ${record.fortune.type}
                            </span>
                            <span style="color: #6b7280; font-size: 0.9rem;">${record.time}</span>
                        </div>
                        <div style="font-weight: bold; margin-bottom: 10px;">${record.fortune.title}</div>
                        <div style="color: #374151; margin-bottom: 10px;">${record.fortune.content}</div>
                        ${record.hasCard ? `
                            <div style="background: #f0fdf4; color: #166534; padding: 10px; border-radius: 8px; margin-top: 10px;">
                                ğŸ è·å¾—å¡ç‰Œ: ${record.card.name}
                            </div>
                        ` : ''}
                    </div>
                `;
                container.appendChild(historyDiv);
            });
        }

        async function submitAI() {
            const gender = document.getElementById('gender').value;
            const consultType = document.getElementById('consultType').value;
            const birthYear = document.getElementById('birthYear').value;
            const question = document.getElementById('question').value;
            
            if (!question.trim()) {
                alert('è¯·è¾“å…¥æ‚¨çš„é—®é¢˜');
                return;
            }
            
            const submitBtn = event.target;
            submitBtn.disabled = true;
            submitBtn.textContent = 'æ­£åœ¨åˆ†æ...';
            
            try {
                const result = await mockAPI.aiConsult({
                    gender: parseInt(gender),
                    consultType,
                    birthYear: birthYear ? parseInt(birthYear) : null,
                    question
                });
                
                // æ˜¾ç¤ºç»“æœ
                document.getElementById('aiSummary').innerHTML = `
                    <h4 style="color: #374151; margin-bottom: 15px;">ğŸ“Š è¿åŠ¿åˆ†æ</h4>
                    <p style="color: #374151; line-height: 1.6;">${result.summary}</p>
                `;
                
                document.getElementById('aiSuggestions').innerHTML = `
                    <h4 style="color: #059669; margin-bottom: 15px;">ğŸ’¡ å»ºè®®æ‚¨</h4>
                    <ul style="color: #374151; line-height: 1.6;">
                        ${result.suggestions.map(s => `<li>â€¢ ${s}</li>`).join('')}
                    </ul>
                `;
                
                document.getElementById('aiCautions').innerHTML = `
                    <h4 style="color: #DC2626; margin-bottom: 15px;">âš ï¸ éœ€è¦æ³¨æ„</h4>
                    <ul style="color: #374151; line-height: 1.6;">
                        ${result.cautions.map(c => `<li>â€¢ ${c}</li>`).join('')}
                    </ul>
                `;
                
                document.getElementById('aiResult').style.display = 'block';
                
            } catch (error) {
                alert('ç®—å‘½å¤±è´¥ï¼Œè¯·é‡è¯•');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'å¼€å§‹ç®—å‘½';
            }
        }
    </script>
</body>
</html>