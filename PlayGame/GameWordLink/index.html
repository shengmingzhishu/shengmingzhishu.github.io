<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.101.0">
    <title>Learning English</title>
    <base :href="rootPath">

    <link rel="canonical" href="https://getbootstrap.com/docs/4.6/examples/cover/">


    <!-- Bootstrap core CSS -->
    <link href="../../assets/dist/css/bootstrap.min.css" rel="stylesheet">


    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
        .box {
            position: absolute;
            background-color: #666;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            width: 150px;
            text-align: center;
            font-size: 20px;
        }

    </style>


    <link href="../common/css/cover.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <script src="../../vue/vue.global.js"></script>
    <!--字典-->
    <script src="../common/dict/dict.js"></script>
    <!--工具-->
    <script src="../common/js/PageUril.js"></script>
</head>
<body class="text-center">
<span id="app" class="langWithe">

    <div class="cover-container d-flex w-100 h-100 h3000 p-3 mx-auto flex-column" v-if="initFinish">
        <header class="masthead mb-auto">
            <div class="inner">
                <h3 class="masthead-brand">Learning English</h3>
                <nav class="nav nav-masthead justify-content-center">
                    <a class="nav-link" href="../../index.html">英语句子</a>
                </nav>
            </div>
        </header>

        <main role="main" class="inner cover">
            <h1 class="cover-heading hide70">Practice in English.</h1>
             <p class="lead">Switch cards and sort them correctly, Help you learn more.</p>
            <p class="lead">
                <button type="button" class="btn btn-warning mr5 mb5 width50" @click="previousPhrase()">Prev</button>
                <button type="button" class="btn btn-warning mr5 mb5 width50" @click="nextPhrase()">Next</button>
                arr:{{arr}}
            </p>

            rootPath:{{rootPath}}<br>
            wordBookList:{{wordBookList}}<br>
            currWordList:{{currWordList}}<br>
         
            <div  v-for="(item, index) in currWordList" @click="checkWord(item)" class="box" :style="{top: item.position.cnTtop+'px', left:item.position.cnLeft+'px' }" v-show="item.showFlag" >
                {{ item.cn }}
            </div>
            <div  v-for="(item, index) in currWordList" @click="checkWord(item)" class="box" :style="{top: item.position.enTtop+'px', left:item.position.enLeft+'px' }" v-show="item.showFlag" >
                {{ item.en }}
            </div>
        
 
        </main>

        <footer class="mastfoot mt-auto">
            <div class="inner">
                <p>Learning English <a href="https://shengmingzhishu.github.io/">Link</a>, by <a
                        href="https://shengmingzhishu.github.io"></a>@Lyon</p>
                <br>
            </div>
        </footer>
    </div>
</span>

<script>
    const {createApp} = Vue
    createApp({
        data() {
            return {
                /**
                 * 全局
                 * */
                initFinish: false,
                that: this,
                /**
                 * 基本信息
                 */ 
                message: 'Hello Vue!',
                rootPath: '', 
                /**
                 * AI code
                 * */
                arr: [1, 2],
                displayArr: [], // 当前页面显示的数组元素
                selectedItems: [], // 已选中的元素
                totalPages: [], // 总页数
                currentPage: 0, // 当前页码
                /**
                 * ai code 2
                 * */
                currPositions: [],
                /**
                 * 分页工具
                 */ 
                 currentPage :1,
                 pageSize: 3,
                /**
                 * 字典集合
                 */ 
                wordBookList: [],
                currWordList: [],
                /**
                 * 随机位置
                 */ 
            }
        },
        mounted() {
            this.rootPath = window.location.protocol + "//" + window.location.host
            this.initCurrPage()
        },
        methods: {
            /**
             * 数据加载
             * */
            initCurrPage(){
                // 初始化页面
                this.message = 'Hello Vue!'
                this.initFinish = true
                // 获取字典集合元素
                this.initWordBookList()
                this.getCurrWordList()
                this.resetCurrWordPositon()
            },
            // 初始化当前单词书
            initWordBookList() {
                this.wordBookList = getDictList()
            },
            getCurrWordList(){
               this.currWordList = getPageData(this.wordBookList, this.currentPage, this.pageSize)
            },
            /**
             * 分页切换
             */ 
            previousPage(){
                this.currWordList = previousPage(this.wordBookList, this.currentPage, this.pageSize)
            },
            nextPage(){
                this.currWordList = nextPage(this.wordBookList, this.currentPage, this.pageSize)
            },
            /**
             * AI code
             * */
            handleClick(item) {
                this.selectedItems.push(item); // 将当前点击的元素添加到已选中数组中
                if (this.selectedItems.length === 2) {
                    if (this.selectedItems[0] === this.selectedItems[1]) {
                        this.removeItems(this.selectedItems[0]); // 如果两个选中元素相同，移除这两个元素
                    }
                    this.selectedItems = []; // 点击了两个元素后，清空已选中元素的数组
                }
            },
            removeItems(val) {
                // 移除已选中的元素
                this.arr =  this.arr.filter(item =>  item !== val )
            },
            changePage(page) {
                this.currentPage = page;
                this.displayArr = this.arr.slice(page * 5, page * 5 + 5);
            },

            /**
             * 位置管理
             * */
            resetCurrWordPositon(){
                if(this.currWordList&& this.currWordList.length>0){
                    for (let i = 0; i < this.currWordList.length; i++) {
                        let word = this.currWordList[i]

                        word['position'] = {}
                        // 显示标记
                        word['showFlag'] = true
                        // 中文位置
                        let cnPosition = this.getRandomPosition(this.currPositions)
                        word['position']['cnTop'] = cnPosition.top 
                        word['position']['cnLeft'] = cnPosition.left 
                        // 英文位置
                        let enPsition = this.getRandomPosition(this.currPositions)
                        word['position']['enTop'] = enPsition.top 
                        word['position']['enLeft'] = enPsition.left 
                    } 
                }
            },
            resetCurrPositions(){
                this.currPositions = []
            },
            getRamdomPositionXX(){
                // 创建一个存储已经随机过的位置的数组，用来避免重复
                let position = this.getRandomPosition(this.currPositions);
                // return { top: position.top + 'px', left: position.left + 'px' }
                return position
            },
            getRandomPosition(currPositions) {
                // 计算可用的位置范围
                let leftRange = window.innerWidth - 300;
                let topRange = window.innerHeight - 300;
                let position = { top: 0, left: 0 };
                // 随机生成位置，直到找到一个不与已有位置重复的位置
                do {
                    position.top = Math.floor(Math.random() * topRange);
                    position.left = Math.floor(Math.random() * leftRange);
                } while (this.isPositionDuplicate(currPositions, position));
                // 创建成功，则添加到占用列表
                this.currPositions.push(position);
                return position;
            },
            isPositionDuplicate(currPositions, position) {
                // 检查已经随机过的位置数组中是否有与给定位置重复的位置
                return currPositions.some(p => {
                    return Math.abs(p.top - position.top) < 200 && Math.abs(p.left - position.left) < 200;
                });
            },

            /**
             * 样式处理
             * */
            // 按长度取模
            toLearningEnglish() {
                window.location = "http://shengmingzhishu.github.io";
            }
        }
    }).mount('#app')
</script>
<style>
    .langWithe {
        width: 100%;
        min-height: 800px;
        /*border: #7abaff 1px solid;*/
    }

    .h3000 {
        height: 3000px;
    }

    .hide70 {
        opacity: 0.5;
    }

    .mr5 {
        margin-right: 5px;
    }

    .mb5 {
        margin-bottom: 5px;
    }

    .width50 {
        width: 80px;
    }


    .cover-container {
        max-width: 442em;
    }

</style>
</body>
</html>