<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="æ–‡æœ¬è½¬Markdownæ ¼å¼åŒ–å·¥å…·">
    <title>æ–‡æœ¬æ ¼å¼åŒ–å·¥å…·</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 100vh;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 
                        "Helvetica Neue", "PingFang SC", 
                        "Microsoft YaHei", sans-serif;
        }

        .container {
            display: flex;
            gap: 20px;
            flex: 1;
        }

        .editor-box {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        textarea {
            flex: 1;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: none;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        #preview {
            flex: 1;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow-y: auto;
            background: #fff;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .header {
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .title {
            font-size: 16px;
            color: #333;
            margin: 0;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 15px;
            background: #07c160;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .btn:hover {
            background: #06ad56;
        }

        .btn.secondary {
            background: #3498db;
        }

        .btn.secondary:hover {
            background: #2980b9;
        }

        /* è¿”å›ä¸»é¡µæŒ‰é’®æ ·å¼ */
        .back-home {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 8px 15px;
            background: #ffd93d;
            color: #333;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            text-decoration: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s ease, opacity 0.3s ease;
            z-index: 1000;
            opacity: 0.7;
        }

        .back-home:hover {
            background: #ffc107;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            opacity: 0.9;
        }

        .back-home::before {
            content: "ğŸ ";
            font-size: 16px;
        }

        /* å¤åˆ¶æŒ‰é’®æ ·å¼ */
        .copy-btn {
            position: fixed;
            bottom: 20px;
            right: 135px;
            padding: 8px 15px;
            background: #07c160;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease, opacity 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 1000;
            opacity: 0.3;
        }

        .copy-btn:hover {
            background: #06ad56;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            opacity: 1;
        }

        .copy-btn::before {
            content: "ğŸ“‹";
            font-size: 16px;
        }

        /* æµ®åŠ¨æç¤ºæ ·å¼ */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #FFD1DC, #FFB5E8); /* æ¸å˜é©¬å¡é¾™è‰² */
            color: #444;
            padding: 12px 24px;
            border-radius: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toast.show {
            opacity: 1;
        }

        .toast::before {
            content: "ğŸˆ"; /* æ›´æ¢ä¸ºæ°”çƒå›¾æ ‡ */
        }
    </style>
</head>
<body>
    <a href="../index.html" class="back-home"> è¿”å›ä¸»é¡µ</a>
    <div class="container">
        <div class="editor-box">
            <div class="header">
                <h3 class="title">åŸå§‹æ–‡æœ¬</h3>
                <div class="button-group">
                    <button class="btn" onclick="loadSampleData()">åŠ è½½ç¤ºä¾‹</button>
                    <button class="btn secondary" onclick="clearInput()">æ¸…ç©º</button>
                </div>
            </div>
            <textarea id="textInput" placeholder="è¯·è¾“å…¥éœ€è¦æ ¼å¼åŒ–çš„æ–‡æœ¬å†…å®¹..."></textarea>
        </div>
        <div class="editor-box">
            <div class="header">
                <h3 class="title">Markdowné¢„è§ˆ</h3>
            </div>
            <div id="preview"></div>
            <button class="copy-btn" onclick="copyMarkdown()">å¤åˆ¶Markdown</button>
        </div>
    </div>

    <!-- æ·»åŠ æç¤ºå…ƒç´  -->
    <div id="toast" class="toast">å¤åˆ¶æˆåŠŸï¼</div>

    <script>
        function formatToMarkdown(text) {
            if (!text.trim()) return '';
            
            const lines = text.split('\n').map(line => line.trim()).filter(line => line);
            let markdown = [];
            let inParagraph = false;
            
            // å¦‚æœæ²¡æœ‰æ˜æ˜¾çš„æ ‡é¢˜ï¼Œæ·»åŠ ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆçš„æ ‡é¢˜
            if (!lines[0].startsWith('#')) {
                const firstLine = lines[0].length > 40 ? 'è‡ªåŠ¨ç”Ÿæˆçš„æ ‡é¢˜' : lines[0];
                markdown.push(`# ${firstLine}\n`);
            }

            function isImportantSentence(sentence) {
                // æ‰©å±•å…³é”®è¯åˆ†ç±»
                const keywords = {
                    // é‡è¦æ€§æ ‡è®°
                    importance: ['é‡è¦', 'å…³é”®', 'æ ¸å¿ƒ', 'æ³¨æ„', 'è­¦å‘Š', 'åˆ‡è®°', 'è°¨è®°', 'å¿…é¡»', 'åŠ¡å¿…'],
                    // æ€»ç»“æ€§æ ‡è®°
                    summary: ['æ€»ç»“', 'ç»“è®º', 'å°ç»“', 'æ¦‚è¿°', 'ç»¼ä¸Š', 'æ€»çš„æ¥è¯´', 'ç®€è€Œè¨€ä¹‹'],
                    // ç‰¹ç‚¹æè¿°
                    features: ['ç‰¹ç‚¹', 'ç‰¹å¾', 'ä¼˜åŠ¿', 'ä¼˜ç‚¹', 'ç‰¹è‰²', 'æ˜¾è‘—', 'ç‹¬ç‰¹'],
                    // å»ºè®®æ€§å†…å®¹
                    suggestions: ['å»ºè®®', 'æ¨è', 'åº”è¯¥', 'æè®®', 'ä¸å¦¨', 'æœ€å¥½'],
                    // å¼ºè°ƒæ ‡è®°
                    emphasis: ['å°¤å…¶', 'ç‰¹åˆ«', 'æ ¼å¤–', 'æå…¶', 'éå¸¸', 'æœ€ä¸º', 'ä¸»è¦'],
                    // è½¬æŠ˜å…³ç³»
                    transition: ['ä½†æ˜¯', 'ç„¶è€Œ', 'ä¸è¿‡', 'ç›¸å', 'åä¹‹'],
                    // å› æœå…³ç³»
                    causality: ['å› æ­¤', 'æ‰€ä»¥', 'å¯¼è‡´', 'å¼•èµ·', 'é€ æˆ'],
                    // æ•°æ®æŒ‡æ ‡
                    metrics: ['å¢é•¿', 'æå‡', 'ä¸‹é™', 'è¶…è¿‡', 'è¾¾åˆ°', 'çªç ´']
                };
                
                // æ£€æŸ¥å¥å­ä¸­æ˜¯å¦åŒ…å«æ•°å­—å’Œå•ä½çš„ç»„åˆ
                const hasMetrics = /\d+\.?\d*\s*[%äº¿ä¸‡å…ƒç¾å…ƒä¸ª]/.test(sentence);
                
                // æ£€æŸ¥å¥å­æ˜¯å¦æ˜¯çŸ­å¥ï¼ˆå¯èƒ½æ˜¯é‡ç‚¹ï¼‰
                const isShortEmphasis = sentence.length <= 15 && sentence.length >= 5;
                
                // æ£€æŸ¥æ˜¯å¦åŒ…å«å…³é”®è¯
                const hasKeyword = Object.values(keywords).some(category => 
                    category.some(keyword => sentence.includes(keyword))
                );
                
                // æ£€æŸ¥æ˜¯å¦åŒ…å«å¼•å·ï¼ˆå¯èƒ½æ˜¯é‡è¦å¼•è¿°ï¼‰
                const hasQuote = /["'""].*["'""]/.test(sentence);
                
                // æ£€æŸ¥æ˜¯å¦åŒ…å«ä¹¦åå·ï¼ˆå¯èƒ½æ˜¯é‡è¦æœ¯è¯­ï¼‰
                const hasBookTitle = /ã€Š.*ã€‹/.test(sentence);
                
                // ç»¼åˆåˆ¤æ–­
                return hasKeyword || 
                       (hasMetrics && sentence.length < 50) || // æ•°æ®ç›¸å…³çš„çŸ­å¥
                       (isShortEmphasis && (hasQuote || hasBookTitle)) || // å¸¦å¼•ç”¨çš„çŸ­å¥
                       (sentence.length < 20 && /[ï¼š:].+/.test(sentence)); // çŸ­çš„è§£é‡Šæ€§å¥å­
            }

            function detectHeadingLevel(line) {
                // æ£€æµ‹è¡Œåº”è¯¥ä½œä¸ºå‡ çº§æ ‡é¢˜
                if (line.length <= 25 && /^[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å][ã€.ï¼]\s*/.test(line)) {
                    return 2; // æ•°å­—ç¼–å·å¼€å¤´çš„çŸ­å¥ä½œä¸ºäºŒçº§æ ‡é¢˜
                }
                if (line.length <= 30 && /^\d+[ã€.ï¼]\s*/.test(line)) {
                    return 3; // æ•°å­—ç¼–å·å¼€å¤´çš„çŸ­å¥ä½œä¸ºä¸‰çº§æ ‡é¢˜
                }
                // è¯†åˆ«å¯èƒ½çš„æ ‡é¢˜æ¨¡å¼
                if (line.length <= 20 && (
                    /^[ã€\[ï¼»].*[ã€‘\]ï¼½]$/.test(line) || // æ–¹æ‹¬å·åŒ…å›´
                    /^ã€.*ã€‘/.test(line) || // æ–¹æ‹¬å·å¼€å¤´
                    /^ï¼».*ï¼½/.test(line) || // å…¨è§’æ–¹æ‹¬å·
                    /^(\d+\.){2,3}\d+/.test(line) || // å¤šçº§æ•°å­—ç¼–å·
                    /^[ï¼ˆ(]([ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]|[1-9])[)ï¼‰]/.test(line) || // å¸¦æ‹¬å·çš„ç¼–å·
                    /^[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å]ã€/.test(line) || // ä¸­æ–‡æ•°å­—ç¼–å·
                    line.startsWith('å…³äº') || // æ”¿ç­–æ–‡ä»¶å¸¸è§å¼€å¤´
                    line.startsWith('å¦‚ä½•') || // é—®é¢˜å‹æ ‡é¢˜
                    /^[A-Z]\./.test(line) // å­—æ¯ç¼–å·
                )) {
                    return 2; // è¾ƒçŸ­çš„å¥å­ä½œä¸ºäºŒçº§æ ‡é¢˜
                }
                return 0; // ä¸ä½œä¸ºæ ‡é¢˜
            }

            function formatParagraph(text) {
                // åˆ†å¥å¤„ç†
                const sentences = text.split(/([ã€‚ï¼ï¼Ÿï¼›])/g).filter(s => s.trim());
                return sentences.map((sentence, index, array) => {
                    sentence = sentence.trim();
                    // ä¿ç•™å¥å­ç»“å°¾çš„æ ‡ç‚¹
                    const punctuation = array[index + 1] || '';
                    
                    if (isImportantSentence(sentence)) {
                        // å¦‚æœå¥å­å·²ç»åŒ…å«åŠ ç²—æ ‡è®°ï¼Œåˆ™ä¸é‡å¤æ·»åŠ 
                        if (sentence.includes('**')) {
                            return sentence + punctuation;
                        }
                        return `**${sentence}**${punctuation}`;
                    }
                    return sentence + punctuation;
                }).join('');
            }

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                // è·³è¿‡ç©ºè¡Œ
                if (!line) {
                    inParagraph = false;
                    markdown.push('');
                    continue;
                }

                // æ£€æµ‹æ ‡é¢˜çº§åˆ«
                const headingLevel = detectHeadingLevel(line);
                if (headingLevel > 0) {
                    inParagraph = false;
                    markdown.push(`${'#'.repeat(headingLevel)} ${line}\n`);
                    continue;
                }

                // å¤„ç†åˆ—è¡¨é¡¹
                if (/^[â€¢Â·\-\*]\s/.test(line) || /^\d+[.ã€]\s/.test(line)) {
                    inParagraph = false;
                    markdown.push(line);
                    continue;
                }

                // å¤„ç†æ™®é€šæ®µè½
                if (!inParagraph) {
                    markdown.push(formatParagraph(line));
                    inParagraph = true;
                } else {
                    markdown[markdown.length - 1] += '\n' + formatParagraph(line);
                }
            }

            return markdown.join('\n\n').replace(/ã€‚+/g, 'ã€‚');
        }

        function updatePreview() {
            const input = document.getElementById('textInput');
            const preview = document.getElementById('preview');
            preview.textContent = formatToMarkdown(input.value);
        }

        // æ˜¾ç¤ºæç¤ºçš„å‡½æ•°
        function showToast(message, duration = 2000) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        function copyMarkdown() {
            const preview = document.getElementById('preview');
            const textarea = document.createElement('textarea');
            textarea.value = preview.textContent;
            document.body.appendChild(textarea);

            try {
                textarea.select();
                document.execCommand('copy');
                showToast('âœ¨ Markdownå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            } catch (err) {
                showToast('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            } finally {
                document.body.removeChild(textarea);
            }
        }

        function loadSampleData() {
            const sampleText = `æ–‡æœ¬æ ¼å¼åŒ–å·¥å…·ä½¿ç”¨æŒ‡å—
è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬æ ¼å¼åŒ–å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿå°†æ™®é€šæ–‡æœ¬è½¬æ¢ä¸ºè§„èŒƒçš„Markdownæ ¼å¼ã€‚

ä½¿ç”¨æ–¹æ³•å’Œç‰¹ç‚¹
1. è‡ªåŠ¨è¯†åˆ«æ ‡é¢˜
å·¥å…·ä¼šè‡ªåŠ¨è¯†åˆ«å¯èƒ½çš„æ ‡é¢˜æ–‡æœ¬ï¼Œå¹¶æ·»åŠ é€‚å½“çš„æ ‡é¢˜çº§åˆ«ã€‚ç‰¹åˆ«æ³¨æ„ï¼šçŸ­å¥å’Œå¸¦ç¼–å·çš„æ–‡æœ¬æ›´å®¹æ˜“è¢«è¯†åˆ«ä¸ºæ ‡é¢˜ã€‚

2. æ™ºèƒ½æ®µè½å¤„ç†
å·¥å…·ä¼šè‡ªåŠ¨å¤„ç†æ®µè½æ ¼å¼ï¼Œä½¿æ–‡æœ¬ç»“æ„æ›´åŠ æ¸…æ™°ã€‚é‡è¦çš„æ˜¯ï¼šæ®µè½ä¹‹é—´ä¼šè‡ªåŠ¨æ·»åŠ é€‚å½“çš„ç©ºè¡Œã€‚

3. é‡ç‚¹å†…å®¹è¯†åˆ«
ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«é‡è¦çš„å¥å­å’Œå…³é”®ä¿¡æ¯ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºç²—ä½“ã€‚æ³¨æ„ï¼šåŒ…å«"é‡è¦"ã€"å…³é”®"ç­‰è¯çš„å¥å­ä¼šè¢«è‡ªåŠ¨åŠ ç²—ã€‚

ä½¿ç”¨å»ºè®®
â€¢ ä¿æŒåŸå§‹æ–‡æœ¬çš„åŸºæœ¬ç»“æ„
â€¢ é€‚å½“æ·»åŠ åˆ†éš”ç¬¦å’Œæ¢è¡Œ
â€¢ é‡è¦å†…å®¹å¯ä»¥é€šè¿‡å…³é”®è¯æ ‡è®°

æœ€åæ€»ç»“
è¿™ä¸ªå·¥å…·çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºæ™ºèƒ½è¯†åˆ«å’Œè‡ªåŠ¨æ ¼å¼åŒ–ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡æ–‡æœ¬æ’ç‰ˆæ•ˆç‡ã€‚æ¨èç»å¸¸å¤„ç†æ–‡æ¡£çš„ç”¨æˆ·ä½¿ç”¨æ­¤å·¥å…·ï¼Œå¯ä»¥èŠ‚çœå¤§é‡æ’ç‰ˆæ—¶é—´ã€‚`;
            
            document.getElementById('textInput').value = sampleText;
            updatePreview();
        }

        function clearInput() {
            document.getElementById('textInput').value = '';
            document.getElementById('preview').textContent = '';
        }

        // ç›‘å¬è¾“å…¥å˜åŒ–
        document.getElementById('textInput').addEventListener('input', updatePreview);

        // åˆå§‹åŠ è½½ç¤ºä¾‹æ•°æ®
        loadSampleData();
    </script>
</body>
</html>